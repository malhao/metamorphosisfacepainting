import{C as q,b as M,z as b,E as y,h as p,w as f,G as W,H as I,b3 as R,T as j,bJ as B,y as U,bc as V,r as N,aL as H,c as L,e as d,I as l,b4 as F,d as $,n as T,F as G,aO as A,j as O,bK as X,m as J,l as K,bL as Q}from"./B1vlILqD.js";import{D as Y,a as Z,b as ee}from"./CK-3t1OA.js";import{u as te,f as oe,a as ne,m as w,r as C,d as ae,M as x}from"./pDZf_5Xx.js";function se(i){const e=new WeakMap,h=te();function g(o){if(i.mode!=="popLayout")return;const a=o.element,r=a.offsetParent,v=r instanceof HTMLElement&&r.offsetWidth||0,n={height:a.offsetHeight||0,width:a.offsetWidth||0,top:a.offsetTop,left:a.offsetLeft,right:0};n.right=v-n.width-n.left;const s=i.anchorX==="left"?`left: ${n.left}`:`right: ${n.right}`;o.element.dataset.motionPopId=o.id;const t=document.createElement("style");h.value.nonce&&(t.nonce=h.value.nonce),e.set(o,t),document.head.appendChild(t),t.sheet&&t.sheet.insertRule(`
    [data-motion-pop-id="${o.id}"] {
      position: absolute !important;
      width: ${n.width}px !important;
      height: ${n.height}px !important;
      top: ${n.top}px !important;
      ${s}px !important;
      }
      `)}function m(o){const a=e.get(o);a&&(e.delete(o),oe.render(()=>{document.head.removeChild(a)}))}return{addPopStyle:g,removePopStyle:m,styles:e}}function D(i){return Promise.resolve().then(()=>{i()})}const ie=q({name:"AnimatePresence",inheritAttrs:!0,__name:"AnimatePresence",props:{mode:{default:"sync"},initial:{type:Boolean,default:!0},as:{},custom:{},onExitComplete:{},anchorX:{default:"left"}},setup(i){const e=i;ne(e);const{addPopStyle:h,removePopStyle:g,styles:m}=se(e);function o(s){let t=s;for(;t;){if(w.get(t))return t;t=t.firstElementChild}return null}function a(s){const t=w.get(s);t&&(g(t),t.isVShow=!0,C(s),D(()=>{t.setActive("exit",!1)}))}const r=new Map;M(()=>{r.clear()});function v(s,t){var P;const c=o(s),u=w.get(c);if(!c||!u){t(),r.size===0&&((P=e.onExitComplete)==null||P.call(e));return}r.set(c,!0),C(c),h(u);function S(_){var E,k;if((E=_?.detail)!=null&&E.isExit){const z=u.visualElement.projection;if(z?.animationProgress>0&&!u.isSafeToRemove&&!u.isVShow)return;C(c),r.delete(c),r.size===0&&((k=e.onExitComplete)==null||k.call(e)),m.has(u)?g(u):u.willUpdate("done"),t(),c.isConnected||u.unmount(!0)}}D(()=>{u.setActive("exit",!0),ae.set(c,S),c.addEventListener("motioncomplete",S)})}const n=b(()=>e.mode!=="wait"?{tag:e.as}:{mode:e.mode==="wait"?"out-in":void 0});return(s,t)=>(p(),y(R(s.mode==="wait"?j:B),I({css:!1},n.value,{appear:"",onEnter:a,onLeave:v}),{default:f(()=>[W(s.$slots,"default")]),_:3},16))}}),le={slots:{base:"rounded-md",overlay:"fixed inset-0 bg-default/75 backdrop-blur-sm will-change-opacity",content:"fixed inset-0 flex items-center justify-center cursor-zoom-out focus:outline-none p-4 sm:p-8"},variants:{zoom:{true:"will-change-transform"},open:{true:""}},compoundVariants:[{zoom:!0,open:!1,class:"cursor-zoom-in"}]},re=["onClick"],fe=Object.assign({inheritAttrs:!1},{__name:"ProseImg",props:{src:{type:String,required:!0},alt:{type:String,required:!0},width:{type:[String,Number],required:!1},height:{type:[String,Number],required:!1},class:{type:null,required:!1},zoom:{type:Boolean,required:!1,default:!0},ui:{type:null,required:!1}},setup(i){const e=i,h=U(),[g,m]=V(),o=N(!1),a=b(()=>A({extend:A(le),...h.uiPro?.prose?.img||{}})({zoom:e.zoom,open:o.value})),r=b(()=>{if(e.src?.startsWith("/")&&!e.src.startsWith("//")){const n=O(X(J().app.baseURL));if(n!=="/"&&!e.src.startsWith(n))return K(n,e.src)}return e.src}),v=b(()=>`${r.value}::${Q()}`);return e.zoom&&H(window,"scroll",()=>{o.value=!1}),(n,s)=>(p(),L(G,null,[d(l(g),null,{default:f(()=>[(p(),y(R(l(F)),I({src:r.value,alt:i.alt,width:i.width,height:i.height},n.$attrs,{class:a.value.base({class:[e.ui?.base,e.class]})}),null,16,["src","alt","width","height","class"]))]),_:1}),i.zoom?(p(),y(l(ee),{key:0,open:o.value,"onUpdate:open":s[0]||(s[0]=t=>o.value=t),modal:!1},{default:f(({close:t})=>[d(l(Y),{"as-child":""},{default:f(()=>[d(l(x),{"layout-id":v.value,"as-child":"",transition:{type:"spring",bounce:.2,duration:.4}},{default:f(()=>[d(l(m))]),_:1},8,["layout-id"])]),_:1}),d(l(Z),null,{default:f(()=>[d(l(ie),null,{default:f(()=>[o.value?(p(),y(l(x),{key:0,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},class:T(a.value.overlay({class:[e.ui?.overlay]}))},null,8,["class"])):$("",!0),o.value?(p(),L("div",{key:1,class:T(a.value.content({class:[e.ui?.content]})),onClick:t},[d(l(x),{"as-child":"","layout-id":v.value,transition:{type:"spring",bounce:.2,duration:.4}},{default:f(()=>[d(l(m))]),_:1},8,["layout-id"])],10,re)):$("",!0)]),_:2},1024)]),_:2},1024)]),_:1},8,["open"])):(p(),y(l(m),{key:1}))],64))}});export{fe as default};
